{"version":3,"file":"lib.js","sourceRoot":"./src/","sources":["lib.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * Constants\n */\nconst bodyDatasetName = \"tsslock\";\nconst elementDatasetName = \"tsslockid\";\nconst styleBackupDatasetName = \"tsslockstyle\";\n\nconst lockStyleHTML = \";overflow:hidden!important;\";\nconst lockStyleBody = \";position:fixed;\";\n\n// used to fix iOS body scrolling when content is not large enough to be scrolled but has overflow-y: scroll\nconst scrollYContentLockStyle = \";overflow-y:unset!important;\";\n\n/**\n * Lock Handler\n */\nexport const removeAllScrollLocks = (observer: ResizeObserver | null) => {\n  window.requestAnimationFrame(() => {\n    getAllLockedElements().forEach((element) => {\n      if (!(element instanceof HTMLElement)) {\n        console.warn(\n            \"removing scroll lock for Element\",\n            element,\n            \"is not possible, as it is not a HTMLElement\"\n        );\n        return;\n      }\n      removeScrollLock(element, observer);\n    });\n    unlockBodyScroll();\n  })\n};\n\nexport const removeScrollLock = (element: HTMLElement, observer: ResizeObserver | null) => {\n  window.requestAnimationFrame(() => {\n    unregisterLockIdOnBody(element);\n    unlockScrollElement(element);\n    if (observer) {\n      observer.disconnect();\n    }\n\n    if (!hasActiveScrollLocks()) {\n      unlockBodyScroll();\n    }\n  })\n};\n\nexport const lockBodyScroll = () => {\n  window.requestAnimationFrame(() => {\n    const html = getHtml();\n    const body = getBody();\n\n    addStyleOverride(html, lockStyleHTML);\n    addStyleOverride(body, lockStyleBody, getDynamicStyleOverride());\n  })\n};\n\nexport const getLockContentScrollResizeObserver = (): ResizeObserver | null => {\n  if (!document) {\n    return null;\n  }\n  return new ResizeObserver((entries) => {\n    if (entries) {\n      const scrollContentElement = entries[0]?.target.parentElement;\n      if (scrollContentElement && scrollContentElement.parentElement) {\n        unlockScrollElement(scrollContentElement);\n        lockContentScrollElement(scrollContentElement.parentElement, scrollContentElement)\n      }\n    }\n  });\n}\n\n// used to fix iOS body scrolling when content is not large enough to be scrolled but has overflow-y: scroll\nexport const lockContentScrollElement = (\n  containerElement: HTMLElement,\n  scrollContentElement: HTMLElement\n) => {\n  const computerContainerStyle = getComputedStyle(containerElement);\n  const containerHeight = containerElement.getBoundingClientRect().height - parseFloat(computerContainerStyle.paddingTop) - parseFloat(computerContainerStyle.paddingBottom);\n  const contentHeight = scrollContentElement.getBoundingClientRect().height;\n  // also get children height as contentHeight might be set to 100% and is scrollable\n  const contentChildrenHeight = getChildNodesHeight(\n    scrollContentElement.children\n  );\n\n  // only lock element if wrapper or children are larger\n  if (\n    containerHeight >= contentHeight &&\n    containerHeight >= contentChildrenHeight\n  ) {\n    lockScrollElement(scrollContentElement);\n  }\n};\n\nconst unlockBodyScroll = () => {\n    const html = getHtml();\n    const body = getBody();\n\n    removeStyleOverride(html);\n    removeStyleOverride(body, true);\n};\n\nconst lockScrollElement = (element: HTMLElement) => {\n  addStyleOverride(element, scrollYContentLockStyle);\n\n  if (isIOS) {\n    element.addEventListener(\"touchmove\", preventTouchmoveHandler);\n  }\n};\n\nconst unlockScrollElement = (element: HTMLElement) => {\n  removeStyleOverride(element);\n  unregisterLockIdOnElement(element);\n\n  if (isIOS) {\n    element.removeEventListener(\"touchmove\", preventTouchmoveHandler);\n  }\n};\n\nconst getDynamicStyleOverride = (): string => {\n  if (window.scrollY > 0) {\n    return `margin-top:-${window.scrollY}px;`;\n  }\n  return `margin-top:0px;`;\n}\n\n/**\n * Inline Style handler\n */\nconst addStyleOverride = (element: HTMLElement, styleOverride: string, dynamicStyleOverride = '') => {\n  if (element.dataset[styleBackupDatasetName]) {\n    // style is already applied\n    return;\n  }\n  // set some style as default\n  element.dataset[styleBackupDatasetName] = '';\n  const currentStyle = element.getAttribute(\"style\");\n  if (currentStyle === null || currentStyle === '') {\n    return element.setAttribute(\"style\", `${styleOverride}${dynamicStyleOverride}`);\n  }\n  if (currentStyle.length > 0) {\n    // store current inline style\n    element.dataset[styleBackupDatasetName] = currentStyle;\n  }\n  return element.setAttribute(\"style\", `${currentStyle}${styleOverride}${dynamicStyleOverride}`);\n};\n\nconst removeStyleOverride = (element: HTMLElement, restoreScrollPosition = false) => {\n  const currentStyle = element.getAttribute(\"style\");\n  if (currentStyle == null) {\n    return;\n  }\n  const storedStyle = element.dataset[styleBackupDatasetName];\n  element.removeAttribute(\"data-\".concat(styleBackupDatasetName))\n  const scrollPosition = Number(element.style.marginTop.replace(\"px\", \"\")) * -1;\n  if (!storedStyle) {\n    element.removeAttribute(\"style\");\n  } else {\n    element.setAttribute(\"style\", storedStyle)\n  }\n\n  if (restoreScrollPosition) {\n    window.scrollTo(0, scrollPosition);\n  }\n};\n\n/**\n * Body Lock Id handling\n */\nexport const registerLockIdOnBody = (id: string) => {\n  const body = getBody();\n  if (!body.dataset[bodyDatasetName]) {\n    body.dataset[bodyDatasetName] = id;\n    return;\n  }\n  if (body.dataset[bodyDatasetName].indexOf(id) > -1) {\n    return;\n  }\n  body.dataset[bodyDatasetName] += `,${id}`;\n};\n\nconst unregisterLockIdOnBody = (element: HTMLElement) => {\n  const body = getBody();\n  if (!body.dataset[bodyDatasetName]) {\n    return;\n  }\n  if (body.dataset[bodyDatasetName].indexOf(\",\") === -1) {\n    body.removeAttribute(`data-${bodyDatasetName}`);\n    return;\n  }\n  const id = getElementLockId(element);\n  body.dataset[bodyDatasetName] = body.dataset[bodyDatasetName].replace(\n    `,${id}`,\n    \"\"\n  );\n\n  return;\n};\n\n/**\n * Element Lock Id handling\n */\nexport const registerLockIdOnElement = (element: HTMLElement, id: string) => {\n  return (element.dataset[elementDatasetName] = id);\n};\n\nconst getElementLockId = (element: HTMLElement) => {\n  return element.dataset[elementDatasetName];\n};\n\nconst getAllLockedElements = () =>\n  document.querySelectorAll(`[data-${elementDatasetName}]`);\n\nconst hasActiveScrollLocks = () => {\n  return getAllLockedElements().length > 0;\n};\n\nconst unregisterLockIdOnElement = (element: HTMLElement) => {\n  return element.removeAttribute(`data-${elementDatasetName}`);\n};\n\n/**\n * DOM Helper\n */\nconst getBody = () => {\n  return getElement('body');\n};\n\nconst getHtml = () => {\n  return getElement('html');\n}\n\nconst getElement = (selector: string): HTMLElement => {\n  const element = document.querySelector(selector);\n  if (!(element instanceof HTMLElement)) {\n    throw `could not locate ${selector} in DOM`\n  }\n  return element;\n}\n\nconst preventTouchmoveHandler = (e: TouchEvent) => {\n  try {\n    e.preventDefault();\n  } catch (e) {}\n};\n\nconst getChildNodesHeight = (children: HTMLCollection) => {\n  let height = 0;\n\n  for (const child of <any>children) {\n    height = height + child.getBoundingClientRect().height;\n  }\n\n  return height;\n};\n\nconst isIOS =\n  typeof window !== \"undefined\" && // prevent SSR context\n  ((navigator.userAgent.indexOf(\"Mac\") > -1 && \"ontouchend\" in document) ||\n    (() => {\n      let isIOSDevice = false;\n      [\"iPad\", \"iPhone\", \"iPod\"].forEach((device: string) => {\n        if (navigator.platform.indexOf(device) > -1) {\n          isIOSDevice = true;\n        }\n      });\n      return isIOSDevice;\n    })());\n"]}